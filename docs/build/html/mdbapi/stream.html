

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Streaming Server &mdash; MusicDB 3.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="MusicDB 3.1.0 documentation" href="../index.html"/>
        <link rel="next" title="MusicDBTags" href="tags.html"/>
        <link rel="prev" title="MusicDB Song Queue" href="songqueue.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MusicDB
          

          
          </a>

          
            
            
              <div class="version">
                3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics/comparison.html">Comparison to Other Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/comparison.html#introducing-other-tools">Introducing other tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/comparison.html#metrics">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/comparison.html#comparison">Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/comparison.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/concept.html">Philosophy of MusicDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/config.html">MusicDB Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#server">server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#websocket">websocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#tls">TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#database">database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#music">music</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#artwork">artwork</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#extern">extern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#tracker">tracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#lycra">lycra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#icecast">Icecast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#musicai">MusicAI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#randy">Randy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#log">log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/config.html#debug">debug</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/logging.html">Handling log-files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/mods.html">MusicDB Commandline Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/mods.html#loading-of-modules">Loading of Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/mods.html#creation-of-new-modules">Creation of new Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/overview.html">Overview of MusicDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/overview.html#music-information-purple">Music Information (Purple)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/overview.html#musicdb-data-blue">MusicDB Data (Blue)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#music-database">Music Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#artwork-cache">Artwork Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#musicdb-data-configuration">MusicDB Data &amp; Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/overview.html#musicdb-components-green">MusicDB Components (Green)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#command-line-modules">Command-Line Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#musicdb-webui">MusicDB WebUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#musicdb-server">MusicDB Server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/overview.html#external-servers-black">External Servers (Black)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#http-server">HTTP Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/overview.html#icecast-server">Icecast Server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/overview.html#consuming-music-orange">Consuming Music (Orange)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/streaming.html">MusicDB Stream</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/streaming.html#general-data-flow">General Data Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/streaming.html#stream-implementation">Stream Implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/testvm.html">MusicDB Test VMs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/testvm.html#qemu-installation">qemu Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#basic-setup">Basic Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#disk-images">Disk Images</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/testvm.html#system-setup">System Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#installing-updating-musicdb-test-environment">Installing/Updating MusicDB Test Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#create-dummy-files">Create Dummy Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/testvm.html#test-systems">Test Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#debian">Debian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#raspian">Raspian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/testvm.html#arch-linux">Arch Linux</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/webapi.html">MusicDB Websocket API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/webapi.html#communication">Communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#packet-format">Packet format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/webapi.html#client-side-interface">Client side interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#callback-functions">Callback functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#send-data-to-the-server">Send data to the server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/webapi.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/webapi.html#module-lib.ws.mdbwsi">Server side API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#artists">Artists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#albums">Albums</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#songs">Songs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#queue">Queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#tag-related">Tag related</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#lyrics">Lyrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/webapi.html#other">Other</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basics/workflow.html">Workflow for development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/workflow.html#working-on-code">Working on code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/workflow.html#rebuilding-the-documentation">Rebuilding the Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/workflow.html#using-git">Using git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics/workflow.html#micro-commits">Micro Commits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/workflow.html#createing-a-hotfix">Createing a Hotfix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics/workflow.html#merging-develop-to-master">Merging Develop to Master</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/workflow.html#releasing-a-new-version">Releasing a New Version</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/install.html">Installation &amp; Update</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/install.html#installation-automatic">Installation (Automatic)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#install-dependencies">Install Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#executing-the-install-sh-script">Executing the install.sh Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#install-all-dependencies">Install all Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#configureing-musicdb">Configureing MusicDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/install.html#installation-manually">Installation (Manually)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#system-preparation">System Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#id1">Install dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#basic-packages">Basic packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#download-musicdb">Download MusicDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#libprinthex">libprinthex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#id3edit">id3edit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/install.html#musicdb">musicdb</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/install.html#configureing-musicdb-webui">Configureing MusicDB WebUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/install.html#cuda-for-musicai">CUDA for MusicAI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/install.html#first-run">First Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/install.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/music.html">Music</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/music.html#naming">Naming</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/music.html#artist-directory-name">Artist Directory Name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/music.html#album-directory-name">Album Directory Name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/music.html#song-file-name">Song File Name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/music.html#importing-albums-to-musicdb">Importing Albums to MusicDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/music.html#using-the-database-module">Using the database module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/music.html#using-the-repair-module">Using the repair module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/music.html#using-the-add-module">Using the add module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/music.html#updating-songs">Updating Songs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/scripts.html">Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/scripts.html#musicdb-boot">musicdb-boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scripts.html#musicdb-shutdown">musicdb-shutdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scripts.html#musicdb-start">musicdb-start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scripts.html#musicdb-stop">musicdb-stop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scripts.html#quickupdate">quickupdate</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">CLI Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mod/add.html">add - Add New Album to MusicDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/add.html#select-album">Select Album</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/add.html#repair-file-names">Repair File Names</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mod/add.html#album-import-form">Album Import Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mod/add.html#new-songs-form">New Songs Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mod/add.html#online-check">Online Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mod/add.html#import-process">Import Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/artwork.html">artwork - Artwork Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/artwork.html#class">class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/cache.html">cache - Music Cache Manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/cache.html#class">class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/database.html">database - Music DB Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/extern.html">extern - Music File Uploader</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/extern.html#class">class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/extern.html#automatization">Automatization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/genres.html">genres - Genre Manager with CLUI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/genres.html#managing-genres">Managing Genres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/genres.html#updating-caches">Updating Caches</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/metadata.html">metadata - Metadata Reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/mise.html">mise - Micro Search Engine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/mise.html#class">class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/moods.html">moods - Mood Tag Manager with CLUI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/moods.html#mood-list">Mood List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/moods.html#mood-grid">Mood Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/moods.html#style-guide">Style Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/musicai.html">musicai - MusicAI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/musicai.html#module-mod.musicai">Module Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/musicai.html#class-description">Class Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/repair.html">repair - Repair Database Entries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/repair.html#lyrics-check">Lyrics Check</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/repair.html#checksum-update">Checksum update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/server.html">server - MusicDB Websocket Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/stats.html">stats - MusicDB Song Statistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/tags.html">tags - MusicDB Tag Manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/tags.html#main-commands">Main commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/tags.html#style-guide">Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/tags.html#example-calls">Example calls</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mod/tracker.html">tracker - Song Tracker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mod/tracker.html#module-mod.tracker">Module Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mod/tracker.html#class-description">Class Description</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Classes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="artwork.html">Artwork Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#database">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#path-structure">Path structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="artwork.html#web-browsers">Web Browsers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#scaling">Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#manifest">Manifest</a></li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#algorithm">Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#musicdbartwork-class">MusicDBArtwork Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="artwork.html#module-lib.cache">ArtworkCache Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="database.html">MusicDBDatabase</a><ul>
<li class="toctree-l2"><a class="reference internal" href="database.html#musicdbdatabase-class">MusicDBDatabase Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extern.html">MusicDBExtern</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extern.html#initializing-a-storage">Initializing a Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="extern.html#storage-configuration">Storage Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="extern.html#the-state-file">The State-File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="extern.html#updating-a-storage">Updating a Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="extern.html#handling-toxic-environments">Handling Toxic Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="extern.html#musicdbextern-class">MusicDBExtern Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lycra.html">LyCra - Lyrics Crawler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lycra.html#module-mdbapi.lycra">Lycra API Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="lycra.html#crawler-base-class">Crawler Base Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="lycra.html#module-lib.db.lycradb">Lycra Database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mise.html">Micro Search Engine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mise.html#musicdbmicrosearchengine-class">MusicDBMicroSearchEngine Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="musicai.html">MusicAI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="musicai.html#external-dependencies">External Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="musicai.html#training-time">Training Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="musicai.html#removing-an-old-model">Removing an old model</a></li>
<li class="toctree-l2"><a class="reference internal" href="musicai.html#data-handling">Data Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="musicai.html#featureset">Featureset</a></li>
<li class="toctree-l3"><a class="reference internal" href="musicai.html#trainingset">Trainingset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="musicai.html#module-mdbapi.musicai">MusicAI Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="musicai.html#musicai-class">MusicAI Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="musiccache.html">MusicCache</a><ul>
<li class="toctree-l2"><a class="reference internal" href="musiccache.html#features-and-constraints">Features and Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="musiccache.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="musiccache.html#updating-the-cache">Updating the Cache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="musiccache.html#add-a-song-to-the-cache">Add a song to the cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="musiccache.html#get-a-songs-path-inside-the-case">Get a songs path inside the case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="musiccache.html#musiccache-class">MusicCache Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="randy.html">Randomizer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="randy.html#module-mdbapi.randy">Randy Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="randy.html#blacklist">Blacklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="randy.html#song-selection-algorithm">Song Selection Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="randy.html#database-stage">Database Stage</a></li>
<li class="toctree-l4"><a class="reference internal" href="randy.html#blacklist-stage">Blacklist Stage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="randy.html#randy-class">Randy Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server.html">MusicDB Websocket Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="songqueue.html">MusicDB Song Queue</a><ul>
<li class="toctree-l2"><a class="reference internal" href="songqueue.html#queue-management">Queue Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="songqueue.html#event-management">Event Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="songqueue.html#song-queue-class">Song Queue Class</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Streaming Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interface">Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#streaming-thread">Streaming Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-queue">Command Queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-management">Event Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stream-manager-class">Stream Manager Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tags.html">MusicDBTags</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tags.html#musicdbtags-class">MusicDBTags Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tracker.html">Song Tracker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tracker.html#tracker-class">Tracker Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracker.html#module-lib.db.trackerdb">Tracker Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracker.html#trackerdatabase-class">TrackerDatabase Class</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lib/clui.html">Command Line User Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.text">Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.frame">Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.pane">Pane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.buttonview">ButtonView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.listview">ListView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.dialog">Dialog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.textinput">TextInput</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.boolinput">BoolInput</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/clui.html#module-lib.clui.tabgroup">TabGroup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/config.html#base-classes">Base Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lib/config.html#module-lib.cfg.config">Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lib/config.html#module-lib.cfg.csv">CSVFile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib/config.html#musicdb-configuration">MusicDB Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/config.html#module-lib.cfg.extern">External Storage Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/config.html#module-lib.cfg.mdbstate">MusicDB State</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/database.html">Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/database.html#database-class">Database Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/fileprocessing.html">Fileprocessing Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/fileprocessing.html#fileprocessing-class">Fileprocessing Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/filesystem.html">Filesystem Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/filesystem.html#filesystem-class">Filesystem Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/gstreamer.html">GStreamer Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/gstreamer.html#gstreamer-pipeline">GStreamer Pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lib/gstreamer.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib/gstreamer.html#gstreamerinterface-class">GStreamerInterface Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/hdf5storage.html">HDF5Storage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/hdf5storage.html#hdf5storage-class">HDF5Storage Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/icecast.html">Icecast Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/icecast.html#introduction-to-icecast">Introduction to Icecast</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lib/icecast.html#icecast-configuration">Icecast Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib/icecast.html#icecast-class">Icecast Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/metatags.html">Meta Tags</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/metatags.html#metatags-class">MetaTags Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/mp3file.html">MP3 File Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/mp3file.html#mp3file-class">MP3File Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/mp3stream.html">MP3 Stream Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/mp3stream.html#mp3stream-class">MP3Stream Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/mp3transcoder.html">MP3 Transcoder</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/mp3transcoder.html#gstreamer-pipeline">GStreamer Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/mp3transcoder.html#unix-pipe">UNIX Pipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/mp3transcoder.html#transcoding">Transcoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/mp3transcoder.html#mp3transcoder-class">MP3Transcoder Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/musicdb.html">MusicDatabase</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#adding-a-column">Adding a Column</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#songs">Songs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#song-relates-methods">Song Relates Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#albums">Albums</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#album-related-methods">Album Related Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#artworks">Artworks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#origin">Origin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#artists">Artists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#lyrics">Lyrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#tags">Tags</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#tag-definition-table">Tag Definition Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#tag-mapping-table">Tag Mapping Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lib/musicdb.html#database-api">Database API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib/musicdb.html#musicdatabase-class">MusicDatabase Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/namedpipe.html">NamedPipe</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/namedpipe.html#namedpipe-class">NamedPipe Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lib/pidfile.html">PID File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/websockets.html">MusicDB Websocket Protocol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lib/websockets.html#module-lib.ws.server">Websocket Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lib/websockets.html#module-lib.ws.websocket">Websocket Protocol</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">JaveScript Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../webui/taginput.html">Tag Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webui/taginput.html#taginput-js">taginput.js</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webui/taginput.html#files">Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webui/taginput.html#musicdb-interface">MusicDB Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webui/taginput.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../webui/taginput.html#tagmanager-js">tagmanager.js</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webui/taginput.html#id1">Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webui/taginput.html#id2">MusicDB Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webui/taginput.html#id3">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webui/websockets.html">Websocket Connection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webui/websockets.html#connection-process">Connection Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webui/websockets.html#watchdog">Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webui/websockets.html#communication-with-the-server">Communication with the server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webui/websockets.html#sending-data">Sending Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webui/websockets.html#receiving-data">Receiving Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../webui/websockets.html#minimal-usage">Minimal usage</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../other/impressum.html">Impressum</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#angaben-gemasz-5-tmg">Angaben gemäß § 5 TMG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#kontakt">Kontakt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#verantwortlich-fur-den-inhalt-nach-55-abs-2-rstv">Verantwortlich für den Inhalt nach § 55 Abs. 2 RStV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#haftung-fur-inhalte">Haftung für Inhalte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#haftung-fur-links">Haftung für Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#urheberrecht">Urheberrecht</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../other/impressum.html#datenschutzerklarung-privacy-statement">Datenschutzerklärung / Privacy Statement</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#datenschutz">Datenschutz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#cookies">Cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#server-log-files">Server-Log-Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#facebook-plugins-like-button">Facebook-Plugins (Like-Button)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#twitter">Twitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#google">Google+</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#youtube">YouTube</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#ssl-verschlusselung">SSL-Verschlüsselung</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/impressum.html#widerspruch-werbe-mails">Widerspruch Werbe-Mails</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MusicDB</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Streaming Server</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/mdbapi/stream.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mdbapi.stream">
<span id="streaming-server"></span><h1>Streaming Server<a class="headerlink" href="#module-mdbapi.stream" title="Permalink to this headline">¶</a></h1>
<p>This module implements the stream that streams the music.
This module provides a thread that takes the songs from a <a class="reference internal" href="songqueue.html#mdbapi.songqueue.SongQueue" title="mdbapi.songqueue.SongQueue"><code class="xref py py-class docutils literal"><span class="pre">mdbapi.songqueue.SongQueue</span></code></a> to stream them via Icecast.
It manages the connection to the Icecast server using the <a class="reference internal" href="../lib/icecast.html#module-lib.stream.icecast" title="lib.stream.icecast"><code class="xref py py-mod docutils literal"><span class="pre">lib.stream.icecast</span></code></a> module.
Further more this module provides some callback interfaces to inform the rest of MusicDB about the state of the stream.</p>
<p>So this module consist of the following parts:</p>
<blockquote>
<div><ul class="simple">
<li>The <a class="reference internal" href="#streaming-thread">Streaming Thread</a> that manages the Song Stream.</li>
<li>An <a class="reference internal" href="#event-management">Event Management</a> that provides a callback interface to get updated about what’s going on in the Streaming Thread.</li>
<li>The <a class="reference internal" href="#mdbapi.stream.StreamManager" title="mdbapi.stream.StreamManager"><code class="xref py py-class docutils literal"><span class="pre">StreamManager</span></code></a> that does management behind streaming.</li>
</ul>
</div></blockquote>
<div class="section" id="interface">
<h2>Interface<a class="headerlink" href="#interface" title="Permalink to this headline">¶</a></h2>
<p>This module maintains a global state!
All functions work on the settings in the <a class="reference internal" href="../lib/config.html#lib.cfg.musicdb.MusicDBConfig" title="lib.cfg.musicdb.MusicDBConfig"><code class="xref py py-class docutils literal"><span class="pre">MusicDBConfig</span></code></a> configuration object and the internal state of this module.</p>
<p>There are two functions and one class that are available to manage the Stream:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mdbapi.stream</span> <span class="kn">import</span> <span class="n">StartStreamingThread</span><span class="p">,</span> <span class="n">StopStreamingThread</span><span class="p">,</span> <span class="n">StreamManager</span>
</pre></div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#mdbapi.stream.StartStreamingThread" title="mdbapi.stream.StartStreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StartStreamingThread()</span></code></a> starts the Streaming Thread that manages the streaming. It also establishes a connection to the Icecast server.</li>
<li><a class="reference internal" href="#mdbapi.stream.StopStreamingThread" title="mdbapi.stream.StopStreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StopStreamingThread()</span></code></a> disconnects MusicDB from Icecast and stops the Streaming Thread</li>
<li><a class="reference internal" href="#mdbapi.stream.StreamManager" title="mdbapi.stream.StreamManager"><code class="xref py py-class docutils literal"><span class="pre">StreamManager</span></code></a> is the class to manage the Stream.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="streaming-thread">
<h2>Streaming Thread<a class="headerlink" href="#streaming-thread" title="Permalink to this headline">¶</a></h2>
<p>The Streaming Thread mainly manages sending mp3-file chunks to the Icecast server.
This thread is the point where the music managed by MusicDB gets handed over to Icecast so the user can listen to it.</p>
<p>The <a class="reference internal" href="#mdbapi.stream.StreamManager" title="mdbapi.stream.StreamManager"><code class="xref py py-class docutils literal"><span class="pre">StreamManager</span></code></a> communicates with the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> with a <a class="reference internal" href="#command-queue">Command Queue</a>.</p>
<p>More details are in the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> description.</p>
<p>The thread maintains a global dictionary that holds the state of the thread - The <strong>Stream State</strong>.
It can be accessed via <a class="reference internal" href="#mdbapi.stream.StreamManager.GetStreamState" title="mdbapi.stream.StreamManager.GetStreamState"><code class="xref py py-meth docutils literal"><span class="pre">mdbapi.stream.StreamManager.GetStreamState()</span></code></a>.
This will only be updated by the StreamingThread.
It contains the following information:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">isconnected</span></code> (bool): <code class="docutils literal"><span class="pre">True</span></code> when connected to Icecast, otherwise <code class="docutils literal"><span class="pre">False</span></code></li>
<li><code class="docutils literal"><span class="pre">isplaying</span></code> (bool): <code class="docutils literal"><span class="pre">True</span></code> when streaming, otherwise <code class="docutils literal"><span class="pre">False</span></code></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="command-queue">
<h2>Command Queue<a class="headerlink" href="#command-queue" title="Permalink to this headline">¶</a></h2>
<p>The Command Queue is a FIFO buffer of tuple.
Each tuple has a command name and an optional argument.
For the whole Module, there is only one global Command Queue.</p>
<p>Each instance of the <a class="reference internal" href="#mdbapi.stream.StreamManager" title="mdbapi.stream.StreamManager"><code class="xref py py-class docutils literal"><span class="pre">StreamManager</span></code></a> class writes into the same queue following the <em>First Come First Serve</em> (FCFS) protocol.
The <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> reads the command from that queue and processes them.</p>
<p>The following commands are available:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">Play</span></code> (<a class="reference internal" href="#mdbapi.stream.StreamManager.Play" title="mdbapi.stream.StreamManager.Play"><code class="xref py py-meth docutils literal"><span class="pre">StreamManager.Play()</span></code></a>):</dt>
<dd>If state is <code class="docutils literal"><span class="pre">True</span></code> the current song from the Song Queue gets streamed to Icecast.
If state is <code class="docutils literal"><span class="pre">False</span></code> the audio stream gets paused.</dd>
<dt><code class="docutils literal"><span class="pre">PlayNextSong</span></code> (<a class="reference internal" href="#mdbapi.stream.StreamManager.PlayNextSong" title="mdbapi.stream.StreamManager.PlayNextSong"><code class="xref py py-meth docutils literal"><span class="pre">StreamManager.PlayNextSong()</span></code></a>):</dt>
<dd>Stops streaming the current song, and starts with the next song.
If streaming is paused, only the next song gets selected as new current song.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="event-management">
<h2>Event Management<a class="headerlink" href="#event-management" title="Permalink to this headline">¶</a></h2>
<p>This module provided a callback interface to react on events triggered by Streaming Thread or by actions done by the <a class="reference internal" href="#mdbapi.stream.StreamManager" title="mdbapi.stream.StreamManager"><code class="xref py py-class docutils literal"><span class="pre">StreamManager</span></code></a> class.</p>
<p>The following two functions can be used to register or remove a callback function:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#mdbapi.stream.StreamManager.RegisterCallback" title="mdbapi.stream.StreamManager.RegisterCallback"><code class="xref py py-meth docutils literal"><span class="pre">RegisterCallback()</span></code></a></li>
<li><a class="reference internal" href="#mdbapi.stream.StreamManager.RemoveCallback" title="mdbapi.stream.StreamManager.RemoveCallback"><code class="xref py py-meth docutils literal"><span class="pre">RemoveCallback()</span></code></a></li>
</ul>
</div></blockquote>
<p>Functions that get called must provide two parameters.
The first is a string that provides the name of the event as described below.
The second parameter contains an event specific argument, or <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>A return value gets not handled.</p>
<p>The following events exist:</p>
<blockquote>
<div><dl class="docutils">
<dt>StatusChanged:</dt>
<dd>Gets triggered when the connection status to Icecast or the play status changed.</dd>
<dt>TimeChanged:</dt>
<dd>The time of the current playing position of a song changed.
Argument is the current playtime of the song in seconds.</dd>
</dl>
</div></blockquote>
<p class="rubric">Example</p>
<p>This example shows how to use the callback interface:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Event &quot;</span><span class="o">%</span><span class="n">s</span><span class="s2">&quot; occurred with argument &quot;</span><span class="o">%</span><span class="n">s</span><span class="s2">&quot;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)))</span>

<span class="n">sq</span> <span class="o">=</span> <span class="n">StreamManager</span><span class="p">(</span><span class="n">mdbconfig</span><span class="p">,</span> <span class="n">musicdatabase</span><span class="p">)</span>
<span class="n">sq</span><span class="o">.</span><span class="n">RegisterCallback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

<span class="c1"># …</span>

<span class="n">sq</span><span class="o">.</span><span class="n">RemoveCallback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="mdbapi.stream.StartStreamingThread">
<code class="descclassname">mdbapi.stream.</code><code class="descname">StartStreamingThread</code><span class="sig-paren">(</span><em>config</em>, <em>musicdb</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StartStreamingThread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StartStreamingThread" title="Permalink to this definition">¶</a></dt>
<dd><p>This function starts the Streaming Thread <code class="xref py py-mod docutils literal"><span class="pre">StreamingThread</span></code>.
You should use this function instead of calling the Streaming Thread function directly.</p>
<p>By calling this function, the global state of this module gets reset.
This included removing all commands from the Command Queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>config</strong> – <a class="reference internal" href="../lib/config.html#lib.cfg.musicdb.MusicDBConfig" title="lib.cfg.musicdb.MusicDBConfig"><code class="xref py py-class docutils literal"><span class="pre">MusicDBConfig</span></code></a> object holding the MusicDB Configuration</li>
<li><strong>database</strong> – A <a class="reference internal" href="../lib/musicdb.html#lib.db.musicdb.MusicDatabase" title="lib.db.musicdb.MusicDatabase"><code class="xref py py-class docutils literal"><span class="pre">MusicDatabase</span></code></a> instance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">True</span></code> on Success, otherwise <code class="docutils literal"><span class="pre">False</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code> – When the arguments are not of the correct type.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdbapi.stream.StopStreamingThread">
<code class="descclassname">mdbapi.stream.</code><code class="descname">StopStreamingThread</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StopStreamingThread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StopStreamingThread" title="Permalink to this definition">¶</a></dt>
<dd><p>This function stops the Streaming Thread.
The function is blocking and waits until the thread is closed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">True</span></code> on success, otherwise <code class="docutils literal"><span class="pre">False</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdbapi.stream.StreamingThread">
<code class="descclassname">mdbapi.stream.</code><code class="descname">StreamingThread</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamingThread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamingThread" title="Permalink to this definition">¶</a></dt>
<dd><p>This thread manages the streaming of the songs from the Song Queue to the Icecast server.</p>
<p>The thread tracks the played song using the <a class="reference internal" href="tracker.html"><span class="doc">Song Tracker</span></a> module.
It also tracks randomly added songs assuming the user skips or removes songs that don’t fit.
Only completely played songs will be considered.
Skipped songs will be ignored.</p>
<p>The thread triggers the following events:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">StatusChanged</span></code>: When the play-state</li>
<li><code class="docutils literal"><span class="pre">TimeChanged</span></code>: To update the current streaming progress of a song</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">TimeChanged</span></code> event gets triggered approximately every second.</p>
</dd></dl>

</div>
<div class="section" id="stream-manager-class">
<h2>Stream Manager Class<a class="headerlink" href="#stream-manager-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mdbapi.stream.StreamManager">
<em class="property">class </em><code class="descclassname">mdbapi.stream.</code><code class="descname">StreamManager</code><span class="sig-paren">(</span><em>config</em>, <em>database</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager" title="Permalink to this definition">¶</a></dt>
<dd><p>This class provides an interface to the Streaming Thread (<a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a>) and the Song Queue that will be streamed.</p>
<p>The communication is implemented with a command queue.
More details about those commands can be found in the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> description.
Anyway, the details of the command queue are not important to know.
They get hide by this class.
Only important thing to know is, that when multiple instances of this class are used, the actions follow the <em>First Come First Server</em> protocol.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Important for developer:</strong></p>
<p class="last">Never call the <a class="reference internal" href="songqueue.html#mdbapi.songqueue.SongQueue.NextSong" title="mdbapi.songqueue.SongQueue.NextSong"><code class="xref py py-meth docutils literal"><span class="pre">mdbapi.songqueue.SongQueue.NextSong()</span></code></a> method directly from this class!
Send the <code class="docutils literal"><span class="pre">&quot;PlayNextSong&quot;</span></code> command to the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> instead.
The thread handles the skip to the next song and starts streaming the new file.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>config</strong> – <a class="reference internal" href="../lib/config.html#lib.cfg.musicdb.MusicDBConfig" title="lib.cfg.musicdb.MusicDBConfig"><code class="xref py py-class docutils literal"><span class="pre">MusicDBConfig</span></code></a> object holding the MusicDB Configuration</li>
<li><strong>database</strong> – A <a class="reference internal" href="../lib/musicdb.html#lib.db.musicdb.MusicDatabase" title="lib.db.musicdb.MusicDatabase"><code class="xref py py-class docutils literal"><span class="pre">MusicDatabase</span></code></a> instance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code> – When the arguments are not of the correct type.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="mdbapi.stream.StreamManager.GetStreamState">
<code class="descname">GetStreamState</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager.GetStreamState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager.GetStreamState" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns the current state of the Streaming Thread as a dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A copy of the Stream state. See the top of the documentation for details of the Stream State.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mdbapi.stream.StreamManager.Play">
<code class="descname">Play</code><span class="sig-paren">(</span><em>play=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager.Play"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager.Play" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the play-state.</p>
<blockquote>
<div><ul class="simple">
<li>If <code class="docutils literal"><span class="pre">play</span></code> is <code class="docutils literal"><span class="pre">True</span></code> (default value), the Streaming Thread streams audio file data to Icecast.</li>
<li>If <code class="docutils literal"><span class="pre">play</span></code> is <code class="docutils literal"><span class="pre">False</span></code>, the stream gets paused.</li>
</ul>
</div></blockquote>
<p>This function is forcing the state. It does not care about the current playing state.</p>
<p>When the command got successful executed,
the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> will trigger the <code class="docutils literal"><span class="pre">StatusChanged</span></code> event.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>play</strong> (<em>bool</em>) – Playstate the Streaming Thread shall get</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">True</span></code> on success. When <code class="docutils literal"><span class="pre">play</span></code> is not a Boolean, <code class="docutils literal"><span class="pre">False</span></code> gets returned.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mdbapi.stream.StreamManager.PlayNextSong">
<code class="descname">PlayNextSong</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager.PlayNextSong"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager.PlayNextSong" title="Permalink to this definition">¶</a></dt>
<dd><p>This function triggers the Streaming Thread to play the next song in the queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">True</span></code> on success, otherwise <code class="docutils literal"><span class="pre">False</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mdbapi.stream.StreamManager.PushCommand">
<code class="descname">PushCommand</code><span class="sig-paren">(</span><em>command</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager.PushCommand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager.PushCommand" title="Permalink to this definition">¶</a></dt>
<dd><p>Class internal interface to the <a class="reference internal" href="#command-queue">Command Queue</a> used to communicate with the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a>.
You should not access the queue directly, because the Streaming Thread expects valid data inside the queue.
This is guaranteed by the methods that use this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>command</strong> (<em>str</em>) – A command to the Streaming Thread. Valid commands are listed in the <a class="reference internal" href="#mdbapi.stream.StreamingThread" title="mdbapi.stream.StreamingThread"><code class="xref py py-meth docutils literal"><span class="pre">StreamingThread()</span></code></a> section of the documentation.</li>
<li><strong>argument</strong> – An argument to the command.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">True</span></code> on success, <code class="docutils literal"><span class="pre">False</span></code> when the Streaming Thread is not running.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mdbapi.stream.StreamManager.RegisterCallback">
<code class="descname">RegisterCallback</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager.RegisterCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager.RegisterCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a callback function that reacts on Streaming related events.
For more details see the module description at the top of this document.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>function</strong> – A function that shall be called on an event.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><em>Nothing</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mdbapi.stream.StreamManager.RemoveCallback">
<code class="descname">RemoveCallback</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mdbapi/stream.html#StreamManager.RemoveCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdbapi.stream.StreamManager.RemoveCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a function from the list of callback functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>function</strong> – A function that shall be called removed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><em>Nothing</em></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Ralf Stemmer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>