

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Scripts &mdash; MusicDB 2017 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="MusicDB 2017 documentation" href="../index.html"/>
        <link rel="next" title="MusicDB Test VMs" href="testvm.html"/>
        <link rel="prev" title="MusicDB Commandline Modules" href="mods.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MusicDB
          

          
          </a>

          
            
            
              <div class="version">
                2017
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="concept.html">Basic Rules for MusicDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">MusicDB Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Handling log-files</a></li>
<li class="toctree-l1"><a class="reference internal" href="mods.html">MusicDB Commandline Modules</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#musicdb-boot">musicdb-boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#musicdb-shutdown">musicdb-shutdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="#musicdb-start">musicdb-start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#musicdb-stop">musicdb-stop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="testvm.html">MusicDB Test VMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="webapi.html">MusicDB Websocket API</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/music.html">Music</a></li>
</ul>
<p class="caption"><span class="caption-text">CLI Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mod/artwork.html">artwork - Artwork Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/database.html">database - Music DB Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/extern.html">extern - Music File Uploader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/metadata.html">metadata - Metadata Reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/mise.html">mise - Micro Search Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/musicai.html">musicai - MusicAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/server.html">server - MusicDB Websocket Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/stats.html">stats - MusicDB Song Statistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/tags.html">tags - MusicDB Tag Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mod/tracker.html">tracker - Song Tracker</a></li>
</ul>
<p class="caption"><span class="caption-text">API Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/artwork.html">Artwork Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/database.html">MusicDBDatabase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/extern.html">MusicDBExtern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/lycra.html">LyCra - Lyrics Crawler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/mise.html">Micro Search Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/mpd.html">mpd / Music Playing Daemon Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/musicai.html">MusicAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/randy.html">Randomizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/server.html">MusicDB Websocket Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/tags.html">MusicDBTags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdbapi/tracker.html">Song Tracker</a></li>
</ul>
<p class="caption"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lib/config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/filesystem.html">Filesystem Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/hdf5storage.html">HDF5Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/metatags.html">Meta Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/musicdb.html">MusicDatabase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/pidfile.html">PID File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/websockets.html">MusicDB Websocket Protocol</a></li>
</ul>
<p class="caption"><span class="caption-text">JaveScript Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../webui/taginput.html">Tag Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webui/websockets.html">Websocket Connection</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MusicDB</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/basics/scripts.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="scripts">
<h1>Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h1>
<p>There are several scripts to make it easyer to use MusicDB.
The scripts and how they work are described in the following sections.</p>
<p>All scripts have no command line arguments.
The last code examples in each subsection give an impression of what the script does.</p>
<p>When and how to use these scripts will be shown in the following code example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Start all depending processes (once after each operating system reboot)</span>
musicdb-boot.sh

<span class="c1"># Start MusicDB itself</span>
musicdb-start.sh

<span class="c1"># If you have to restart the server, do the following:</span>
musicdb-stop.sh <span class="o">&amp;&amp;</span> musicdb-start.sh

<span class="c1"># Stop MusicDB</span>
musicdb-stop.sh

<span class="c1"># Stop all depending processes (befor shutting down the whole operating system)</span>
musicdb-shutdown.sh
</pre></div>
</div>
<div class="section" id="musicdb-boot">
<h2>musicdb-boot<a class="headerlink" href="#musicdb-boot" title="Permalink to this headline">¶</a></h2>
<p>This script starts all depending processes that are needed by the server.
Only exception is the HTTP server that must be started by the user.</p>
<p>All processes get started with the configuration made for MusicDB.
This is done by determin the configuration directory of MusicDB.
In this directory, the related configuration files are placed.
They are used.</p>
<p>The configuration directory will be determined by checking in which directory the musicdb.ini in /etc is linked to.
So if /etc/musicdb.ini is linked to /data/musicdb/musicdb.ini, then /data/musicdb is the used directory.
In the following text just called <code class="docutils literal"><span class="pre">$CFGDIR</span></code>.</p>
<p>These are the processes that gets started with the annotated configuration:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">mpd</span></code> with <code class="docutils literal"><span class="pre">$CFGDIR/mpd/mpd.conf</span></code></li>
<li><code class="docutils literal"><span class="pre">icecast[2]</span></code> with <code class="docutils literal"><span class="pre">$CFGDIR/icecast/config.xml</span></code></li>
</ul>
</div></blockquote>
<p>Those files and the directory structure should be generated by the installation process.</p>
<p><code class="docutils literal"><span class="pre">musicdb-boot</span></code> first checks if the processes are already running.
If that is the case, they get killed and restarted.</p>
<p>You need to be <em>root</em> to execute the script.
The processes started by this script will run with their own user ID as configured in their configurations.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mpd <span class="nv">$MPDCONFIG</span>
icecast -b -c <span class="nv">$ICECASTCONFIG</span> &gt; /dev/null
</pre></div>
</div>
</div>
<div class="section" id="musicdb-shutdown">
<h2>musicdb-shutdown<a class="headerlink" href="#musicdb-shutdown" title="Permalink to this headline">¶</a></h2>
<p>Same procedure as <code class="docutils literal"><span class="pre">musicdb-boot</span></code>.
Just instead of starting the processes, they get stopped.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mpd --kill &gt; /dev/null <span class="m">2</span>&gt;<span class="nv">$1</span>
killall icecast &gt; dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="section" id="musicdb-start">
<h2>musicdb-start<a class="headerlink" href="#musicdb-start" title="Permalink to this headline">¶</a></h2>
<p>This scripts starts the MusicDB WebSocket Server.
If the server is already running (determined by the existence of the PID-file), nothing will be done.
The server gets executed with the user ID of the user <code class="docutils literal"><span class="pre">musicdb</span></code>.
This user should be created during the installation process</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>su -l -c <span class="s2">&quot;musicdb server&quot;</span> <span class="s2">&quot;musicdb&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="musicdb-stop">
<h2>musicdb-stop<a class="headerlink" href="#musicdb-stop" title="Permalink to this headline">¶</a></h2>
<p>This script stops the MusicDB server.
It reads the configuration (/etc/musicdb.ini) to determine the pid-file in which the PID of the MusicDB server is stored.
Then the server just gets killed by its PID.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">kill</span> <span class="k">$(</span> cat <span class="nv">$MUSICDB_PIDFILE</span> <span class="k">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="testvm.html" class="btn btn-neutral float-right" title="MusicDB Test VMs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mods.html" class="btn btn-neutral" title="MusicDB Commandline Modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Ralf Stemmer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2017',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>